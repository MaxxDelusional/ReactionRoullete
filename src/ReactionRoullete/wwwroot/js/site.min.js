function PostBlob(e,o,t){var r=new FormData;r.append(o,t),r.append(o+"-blob",e),xhr(callbackurl,r,null,null,function(e){var o=JSON.parse(e);o.success&&(window.location=o.redirectUrl)})}function xhr(e,o,t,r,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){4==i.readyState&&200==i.status&&n&&n(i.responseText)},-1==e.indexOf("/RecordRTC/DeleteFile")&&(r&&(i.upload.onloadstart=function(){r.innerHTML="Upload started..."}),t&&(i.upload.onprogress=function(e){t.max=e.total,t.value=e.loaded,r.innerHTML="Upload Progress "+Math.round(e.loaded/e.total*100)+"%"}),r&&(i.upload.onload=function(){r.innerHTML="Saved!"})),i.open("POST",e),i.send(o)}function onYouTubeIframeAPIReady(){youtubePlayer=new YT.Player("youtubePlayer",{height:"300",width:"400",videoId:youtubeVideoID,events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}})}function onPlayerReady(e){}function onPlayerStateChange(e){e.data!=YT.PlayerState.PLAYING||done||(done=!0)}function playVideo(){youtubePlayer.playVideo()}function stopVideo(){youtubePlayer.stopVideo()}var record=document.getElementById("React"),stop=document.getElementById("Stop"),recordVideo=document.getElementById("record-video"),preview=document.getElementById("preview"),container=document.getElementById("container"),isFirefox=!!navigator.mozGetUserMedia,recordAudio,recordVideo;record.onclick=function(){record.disabled=!0,navigator.getUserMedia({audio:!1,video:!0},function(e){youtubePlayer&&playVideo(),preview.src=window.URL.createObjectURL(e),preview.play(),recordAudio=RecordRTC(e,{onAudioProcessStarted:function(){isFirefox||recordVideo.startRecording()}}),isFirefox&&recordAudio.startRecording(),isFirefox||(recordVideo=RecordRTC(e,{type:"video"}),recordAudio.startRecording()),stop.disabled=!1},function(e){alert(JSON.stringify(e,null,"	"))})};var fileName;stop.onclick=function(){youtubePlayer&&stopVideo(),record.disabled=!1,stop.disabled=!0,preview.src="",fileName=Math.round(99999999*Math.random())+99999999,isFirefox&&recordAudio.stopRecording(function(e){preview.src=e,PostBlob(recordAudio.getBlob(),"video",fileName+".webm")}),isFirefox||recordVideo.stopRecording(function(){PostBlob(recordVideo.getBlob(),"video",fileName+".webm")})},window.onbeforeunload=function(){},navigator.getUserMedia({audio:!1,video:!0},function(e){},function(e){});var youtubePlayer,tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);var done=!1;